Γιάννης Δαλιάνης

1115201700027

Το πρόγραμμα γίνεται compile με την εντολή make all. Εκτελείται
σε τρία διαφορετικά παράθυρα στο terminal ως εξής: πρώτα make masterP
στο ένα παράθυρο, μετά από λίγο make master σε άλλο παράθυρο κα τέλος
make Client σε ένα τρίτο παράθυρο. Ο master και ο client τερματίζονται
από μόνοι τους, ενώ ο σέρβερ με ctrl+C.

Το πρόγραμμα master στέλνει σε κάθε worker τις χώρες που θα
αναλάβουν καθώς και τις πληροφορίες για τη σύνδεση με τον
whoServer(port, IP address).

O whoServer χρησιμοποιεί μια δομή με πληροφορίες για τα workers
με τα οποία θα επικοινωνεί όπως το pid τους και το port τους. Τα
ίδια τα workers τον ενημερώνουν για το πλήθος τους. Ο πίνακας
ArrayOfSocketFunc χρησιμοποιείται για προσδιορίζουμε την ιδιότητα
κάθε σύνδεσης προς τον σέρβερ, αν δηλαδή αυτή προέρχεται από worker
ή από client.Με κάθε νέα σύνδεση που λαμβάνει, ο σέρβερ τοποθετεί
το συγκεκριμένο file descriptor σε ένα σετ το οποίο παρακολουθεί.
Όταν κάποια σύνδεση αιτηθεί κάποια εργασία, ένα thread ξυπνάει και
την πραγματοποιεί. Σε μία δομή myThreadQue τοποθετούνται αυτές οι
εργασίες για να μπορούν να καταλάβουν τα threads πώς πρέπει να τις
διαχειριστούν. Στη γραμμή 223 του αρχείου βρίσκεται whoServer.c
βρίσκεται η εντολή που εκτυπώνει τα στατιστικά που φτάνουν στο σέρβερ.
Όταν τα queries ολοκληρωθούν, ο σέρβερ ενημερώνει τα workers με το
μήνυμα ENDOFQUERRIES.

Οι workers δίνουν σαν port ο καθένας το pid του με κολλημένο μπροστά
το 1.